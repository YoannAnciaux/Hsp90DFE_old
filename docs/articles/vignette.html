<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fit of distributions of fitness effects derived from Fisher's geometric model using maximum likelihood estimation • Hsp90DFE</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fit of distributions of fitness effects derived from Fisher's geometric model using maximum likelihood estimation">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Hsp90DFE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette.html">Fit of distributions of fitness effects derived from Fisher's geometric model using maximum likelihood estimation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Fit of distributions of fitness effects derived from Fisher’s geometric model using maximum likelihood estimation</h1>
            
      
      
      <div class="hidden name"><code>vignette.Rmd</code></div>

    </div>

    
    
<div id="data" class="section level1">
<h1 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h1>
<div class="figure">
<img src="vignette_files/figure-html/data-plot-1.png" alt="Distribution of mutation effects on fitness measured in each environment." width="700"><p class="caption">
Distribution of mutation effects on fitness measured in each environment.
</p>
</div>
</div>
<div id="distribution-of-fitness-effects-dfe" class="section level1">
<h1 class="hasAnchor">
<a href="#distribution-of-fitness-effects-dfe" class="anchor"></a>Distribution of fitness effects (DFE)</h1>
<p>The probability density function (pdf) of the DFE in the “standard” isotropic FGM from <span class="citation">Martin and Lenormand (<a href="#ref-martinFitnessEffectMutations2015">2015</a>)</span>, is fully determined by (<span class="math inline">\(n\)</span>, <span class="math inline">\(\lambda\)</span>, <span class="math inline">\(s_0\)</span>) and has the following stochastic representation and pdf :</p>
<span class="math display">\[\begin{equation}
\begin{array}{c}
{S \sim s_{0}-\frac{\lambda}{2} \chi_{n}^{2}\left(\frac{2 s_{0}}{\lambda}\right)} \\
{f_{S}\left(s, n, \lambda, s_{0}\right)=\frac{2}{\lambda} f_{\chi_{n}^{2}}\left(\frac{2\left(s_{0}-s\right)}{\lambda}, \frac{2 s_{0}}{\lambda}\right)}
\end{array} (\#eq:DFE-FGM-Martin)
\end{equation}\]</span>
<p>With <span class="math inline">\(n\)</span> the dimensionality, i.e. the number of phenotypic dimensions (traits) under selection, <span class="math inline">\(\lambda\)</span> the mutational variance per trait among random mutations scaled by the strength of selection (scales the mean fitness effect of mutations) and <span class="math inline">\(s_0\)</span> the fitness distance between the wild type and the optimum of the environment.</p>
If we consider a more general fitness function for the FGM (still assuming isotropy) as in <span class="citation">(Olivier Tenaillon et al. <a href="#ref-tenaillonQuantifyingOrganismalComplexity2007">2007</a>)</span>, which takes the form <span class="math inline">\(s(d) = - \alpha d^Q\)</span> (in the standard model above <span class="math inline">\(\alpha = 1/2\)</span> and <span class="math inline">\(Q = 2\)</span>), the DFE has the following pdf <span class="citation">(O. Tenaillon <a href="#ref-tenaillonUtilityFisherGeometric2014">2014</a>)</span>:
<span class="math display">\[\begin{equation}
f(s)=\frac{e^{-\frac{\left(\frac{s_{0}-s}{\alpha}\right)^{2/Q}+\left(\frac{s_{0}}{a}\right)^{2/Q}}{2 \lambda^2}}}{\alpha Q \lambda^{2}}\left(\frac{s_{0}-s}{\alpha}\right)^{\frac{\frac{n}{2}+1-Q}{Q}}\left(\frac{s_{0}}{\alpha}\right)^{\left(1-\frac{n}{2}\right) / Q} I_{\frac{n}{2}-1}\left(\frac{1}{\lambda^2}\left(\frac{s_{0}-s}{\alpha}\right)^{1/Q}\left(\frac{s_{0}}{\alpha}\right)^{1/Q}\right) (\#eq:DFE-FGM-Tenaillon)
\end{equation}\]</span>
<p>With <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(Q\)</span> robustness and epistasis parameter influencing the decay rate and the curvature of the fitness function described above.</p>
</div>
<div id="fit-of-the-dfe-using-maximum-likelihood-estimation-mle" class="section level1">
<h1 class="hasAnchor">
<a href="#fit-of-the-dfe-using-maximum-likelihood-estimation-mle" class="anchor"></a>Fit of the DFE using maximum likelihood estimation (MLE)</h1>
<p>In each environment, the average of the selection coefficients of the three replicates, for each combination of position and amino acid (see figure @ref(fig:data-plot) ), was fitted against either the standard <span class="citation">(Martin and Lenormand <a href="#ref-martinFitnessEffectMutations2015">2015</a>)</span> (eq. @ref(eq:DFE-FGM-Martin)) or the full <span class="citation">(O. Tenaillon <a href="#ref-tenaillonUtilityFisherGeometric2014">2014</a>)</span> (eq. @ref(eq:DFE-FGM-Tenaillon)) FGM described above. The fit was performed by maximum likelihood estimation using the R package <em>maxLik</em> <span class="citation">(Toomet et al. <a href="#ref-toometMaxLikMaximumLikelihood2020">2020</a>)</span> with the “Nelder-Mead” <span class="citation">(Nelder and Mead <a href="#ref-nelderSimplexMethodFunction1965">1965</a>)</span> optimization method. In figures @ref(fig:mle-fgm-martin-plot) and @ref(fig:mle-fgm-tenaillon-plot) are shown the results of the fit for the standard and the full model.</p>
<p>In both figures both the fit on all the combinations of positions and amino acids (in dark oange and dark blue) and the fit on the upper 85% of the distribution (in light orange and light blue) are shown. The likelihoods obtained by maximisation on the complete and the truncated data cannot be compared directly but we can see in both figures that the fit on the truncated data is visually better. Indeed, all the distributions show a heavy tail for strongly deleterious mutation which is not expected in the FGM. The comparison between the fit of the standard model and the full model shows similar results.</p>
<p>Figure @ref(fig:mle-fgm-estim-plot) shows that the number of dimensions <span class="math inline">\(n\)</span> estimaded varies across environment and also across the models used for the fit. The distance to the optimum <span class="math inline">\(s_0\)</span> estimated are similar across models. The lowest value for <span class="math inline">\(s_0\)</span> has been estimaded for the standard environment, which is consistent with the fact that the wild type was adapted to this environment. The values estimated for the variance of mutation effects <span class="math inline">\(\lambda\)</span> are lower and similar across environment for the fits on 85% of the data, which is an artefact expected when removing the 15% most deleterious mutations.</p>
<p>In figure @ref(fig:mle-fgm-martin-plot), @ref(fig:mle-fgm-tenaillon-plot) and @ref(fig:mle-fgm-estim-plot) the environment “low” are not shown as the fit procedure is not converging for some of them.</p>
<p>(ref:mle-fgm-martin-caption) <strong>MLE for standard FGM</strong>. Fit of the standard model @ref(eq:DFE-FGM-Martin) using maximum likelihood estimation for each environment.</p>
<div class="figure">
<img src="vignette_files/figure-html/mle-fgm-martin-plot-1.png" alt="(ref:mle-fgm-martin-caption)" width="700"><p class="caption">
(ref:mle-fgm-martin-caption)
</p>
</div>
<p>(ref:mle-fgm-tenaillon-caption) <strong>MLE for full FGM</strong>. Fit of the full model @ref(eq:DFE-FGM-Tenaillon) (with <span class="math inline">\(\alpha = 1/2\)</span>) using maximum likelihood estimation for each environment.</p>
<div class="figure">
<img src="vignette_files/figure-html/mle-fgm-tenaillon-plot-1.png" alt="(ref:mle-fgm-tenaillon-caption)" width="700"><p class="caption">
(ref:mle-fgm-tenaillon-caption)
</p>
</div>
<p>(ref:mle-fgm-estim-caption) <strong>Estimate of the parameters</strong> for both the standard model @ref(eq:DFE-FGM-Martin) and the full @ref(eq:DFE-FGM-Tenaillon) model (with <span class="math inline">\(\alpha = 1/2\)</span>), fitted by maximum likelihood estimation for each environment. The absence of value for certain cases corresponds to a fail of the maximisation algorithm.</p>
<div class="figure">
<img src="vignette_files/figure-html/mle-fgm-estim-plot-1.png" alt="(ref:mle-fgm-estim-caption)" width="700"><p class="caption">
(ref:mle-fgm-estim-caption)
</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-martinFitnessEffectMutations2015">
<p>Martin, Guillaume, and Thomas Lenormand. 2015. “The Fitness Effect of Mutations Across Environments: Fisher’s Geometrical Model with Multiple Optima.” <em>Evolution</em> 69 (6): 1433–47. doi:<a href="https://doi.org/10.1111/evo.12671">10.1111/evo.12671</a>.</p>
</div>
<div id="ref-nelderSimplexMethodFunction1965">
<p>Nelder, J. A., and R. Mead. 1965. “A Simplex Method for Function Minimization.” <em>The Computer Journal</em> 7 (4): 308–13. doi:<a href="https://doi.org/10.1093/comjnl/7.4.308">10.1093/comjnl/7.4.308</a>.</p>
</div>
<div id="ref-tenaillonUtilityFisherGeometric2014">
<p>Tenaillon, O. 2014. “The Utility of Fisher’s Geometric Model in Evolutionary Genetics.” <em>Annual Review of Ecology, Evolution, and Systematics</em> 45 (November): 179–201. doi:<a href="https://doi.org/10.1146/annurev-ecolsys-120213-091846">10.1146/annurev-ecolsys-120213-091846</a>.</p>
</div>
<div id="ref-tenaillonQuantifyingOrganismalComplexity2007">
<p>Tenaillon, Olivier, Olin K. Silander, Jean-Philippe Uzan, and Lin Chao. 2007. “Quantifying Organismal Complexity Using a Population Genetic Approach.” <em>PLOS ONE</em> 2 (2): e217. doi:<a href="https://doi.org/10.1371/journal.pone.0000217">10.1371/journal.pone.0000217</a>.</p>
</div>
<div id="ref-toometMaxLikMaximumLikelihood2020">
<p>Toomet, Ott, Arne Henningsen, with contributions from Spencer Graves, and Yves Croissant. 2020. “maxLik: Maximum Likelihood Estimation and Related Tools.”</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#data">Data</a></li>
      <li><a href="#distribution-of-fitness-effects-dfe">Distribution of fitness effects (DFE)</a></li>
      <li><a href="#fit-of-the-dfe-using-maximum-likelihood-estimation-mle">Fit of the DFE using maximum likelihood estimation (MLE)</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Yoann Anciaux.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
